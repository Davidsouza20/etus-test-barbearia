{"remainingRequest":"/home/david/Documents/barberShopFront/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/david/Documents/barberShopFront/src/views/Register.vue?vue&type=style&index=0&id=63ae9146&scoped=true&lang=css&","dependencies":[{"path":"/home/david/Documents/barberShopFront/src/views/Register.vue","mtime":1591997511173},{"path":"/home/david/Documents/barberShopFront/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.mercadop {\n    display: flex;\n    justify-content: space-between;\n}\n.width50 {\n    width: 48%;\n}\n.margin15 {\n    margin-top: 15px;\n}\nselect {\n    margin-right: 5px;\n}\n\n.flex{\n    display: flex;\n    justify-content: space-between;     \n}\n\n#register {\n    max-width: 600px;\n    border: 1px solid #CCCCCC;\n    background-color: #FFFFFF;\n    margin: auto;\n    margin-top: 30px;\n    padding: 20px;\n}\n\n.green {\n    background-color: #38ef7d;\n    color: #ffffff;\n    font-weight: bold;\n}\n\nh3 {\n    margin-top: 20px;\n    color: rgb(95, 0, 172);\n    font-weight: bold;\n}\n\nh4 {\n    padding: 15px;\n}\n\nh5 {\n    color: rgb(246, 55, 226);\n    font-weight: bold;\n}\n\nbutton {\n    margin-top: 15px;\n}\n\niframe {\n    width: 100%;\n    height: 80vh;\n    border: none;\n}\n\nimg {\n    max-width: 170px;\n}\n",{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Register.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <!--<div>\n            <h3> 12 meses de acesso ilimitado</h3>\n            <h4>Aulas novas toda semana e uma rotina de treinos personalizada para você.  <br><br> Elimine a gordura indesejada se divertindo.</h4>\n        </div> -->\n        <br>\n        <img src=\"img/garantee.png\" alt=\"Garantia\">\n\n        <form action=\"\" method=\"POST\"  id=\"pay\" name=\"pay\" v-on:change=\"checkForm\">\n         <div id=\"register\">\n            <h4 class=\"modal-title w-100 font-weight-bold\">Dados Pessoais</h4>\n            <div class=\"form-group\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n                <input type=\"text\" required class=\"form-control\"  placeholder=\"Nome\" v-model=\"user_name\">\n\n                <i class=\"fa fa-phone\"></i>\n                <input type=\"text\" class=\"form-control\" aria-describedby=\"emailHelp\" placeholder=\"Telefone\" v-model=\"phone\">\n\n                <i class=\"fa fa-envelope-o\" aria-hidden=\"true\"></i>\n                <input type=\"email\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"E-mail\" v-model=\"email\">\n            </div>\n            <div class=\"form-group\">\n                <i class=\"fa fa-lock\" aria-hidden=\"true\"></i>\n                <input type=\"password\" class=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Senha\" v-model=\"password\">\n            </div>  \n            <div v-if=\"errors.length\" class=\"alert alert-danger\" role=\"alert\">\n            <span v-for =\"error in errors\" :key=\"error.id\">{{ error }}<br></span>\n        </div>     \n        </div>\n\n        <div id=\"register\">\n            <div class=\"mercadop\">\n                <h4 class=\"modal-title font-weight-bold\">Cartão de Crédito</h4>\n                <img src=\"/img/mercadopago.png\" alt=\"\">\n            </div>\n            \n            \n            <div class=\"form-group\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n                <input type=\"text\" class=\"form-control\"  placeholder=\"Nome impresso no cartão\" v-model=\"user_name\" id=\"cardholderName\" data-checkout=\"cardholderName\">\n\n                <i class=\"fa fa-credit-card\"></i>\n                <input type=\"text\" class=\"form-control\" id=\"cardNumber\" data-checkout=\"cardNumber\" placeholder=\"Número do Cartão de Crédito\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off  v-on:keyup=\"guessingPaymentMethod\" v-on:change=\"guessingPaymentMethod\" v-model=\"cardNumber\"/>\n\n                <div class=\"flex margin15\">\n                    <div class=\"width50\">\n                        <label>Validade do Cartão</label>\n                        <div class=\"flex\">\n                            <select class=\"form-control\" id=\"cardExpirationMonth\" data-checkout=\"cardExpirationMonth\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off>\n                                <option value=\"01\">01 - janeiro</option>\n                                <option value=\"02\">02 - fevereiro</option>\n                                <option value=\"03\">03 - março</option>\n                                <option value=\"04\">04 - abril</option>\n                                <option value=\"05\">05 - maio</option>\n                                <option value=\"06\">06 - junho</option>\n                                <option value=\"07\">07 - julho</option>\n                                <option value=\"08\">08 - agosto</option>\n                                <option value=\"09\">09 - setembro</option>\n                                <option value=\"10\">10 - outubro</option>\n                                <option value=\"11\">11 - novembro</option>\n                                <option value=\"12\">12 - dezembro</option>\n                            </select>\n\n                            <select class=\"form-control\" id=\"cardExpirationYear\" data-checkout=\"cardExpirationYear\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off>\n                                <option value=\"2020\">2020</option>\n                                <option value=\"2021\">2021</option>\n                                <option value=\"2022\">2022</option>\n                                <option value=\"2023\">2023</option>\n                                <option value=\"2024\">2024</option>\n                                <option value=\"2025\">2025</option>\n                                <option value=\"2026\">2026</option>\n                                <option value=\"2027\">2027</option>\n                                <option value=\"2028\">2028</option>\n                                <option value=\"2029\">2029</option>\n                                <option value=\"2030\">2030</option>\n                                <option value=\"2031\">2031</option>\n                                <option value=\"2032\">2032</option>\n                                <option value=\"2033\">2033</option>\n                                <option value=\"2034\">2034</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div class=\"width50\">\n                        <label for=\"cardNumber\">Código de Segurança</label>\n                        <input type=\"text\" class=\"form-control\" id=\"securityCode\" data-checkout=\"securityCode\" placeholder=\"CVV\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off v-model=\"cvv\">  \n                    </div>\n                </div>  \n\n                <div class=\"flex margin15\">\n                    <div class=\"width50\">\n                        <label for=\"docType\">Tipo do Documento</label><br>\n                        <select id=\"docType\" class=\"form-control\" data-checkout=\"docType\"></select>\n                    </div>\n                    \n                    <div class=\"width50\">\n                        <label for=\"docNumber\">Número do Documento</label><br>\n                        <input type=\"text\" id=\"docNumber\" class=\"form-control\" data-checkout=\"docNumber\" placeholder=\"***.***.***-**\" v-model=\"cpf\"/>\n                    </div>\n                </div>\n                 \n                 <div class=\"margin15\">\n                     <i class=\"fa fa-money\" aria-hidden=\"true\"></i>&nbsp;&nbsp;\n                     <label for=\"installments\">Parcelamento</label>\n                    <select id=\"installments\" class=\"form-control\" name=\"installments\" v-model=\"option\"></select>\n                 </div>\n            </div>\n            <div v-if=\"card_errors.length\" class=\"alert alert-danger\" role=\"alert\">\n                <span v-for =\"error in card_errors\" :key=\"error.id\">{{ error }}<br></span>\n            </div>    \n        </div>\n        \n        <input type=\"hidden\" name=\"amount\" id=\"amount\" v-model=\"transaction_amount\"/>\n        <input type=\"hidden\" name=\"description\"/>\n        <input type=\"hidden\" name=\"paymentMethodId\" v-model=\"payment_method_id\"/>\n\n         \n        <br>\n        <input type=\"submit\" class=\"btn green\" @click=\"doPay\" value=\"Eu quero emagrecer\">\n        </form>\n        <br>\n\n        <loading :active.sync=\"isLoading\" \n        :can-cancel=\"false\" \n        :on-cancel=\"() => {}\"\n        :is-full-page=\"fullPage\"\n        :loader=\"'dots'\"\n        :color=\"'#38ef7d'\"></loading>\n    </div>\n    \n\n</template>\n<script>\nimport api from '../services/api'\nimport Loading from 'vue-loading-overlay'\nimport 'vue-loading-overlay/dist/vue-loading.css'\n\nexport default {\n    name: 'Register',\n        components: {\n                Loading\n        },\n        \n        data() {\n            return {\n                auth_response: '',\n                isLoading: false,\n                fullPage: true,\n                errors: [],\n                card_errors: [],\n                user_name: \"\",\n                email: \"\",\n                phone: \"\",\n                password: \"\",\n                response: \"\",\n                error: false,\n                doSubmit: false,\n                card: document.createElement('input'),\n                installments: '',\n                token: '',\n                transaction_amount: '211,32',\n                description: '', \n                payment_method_id: '',\n                option: '',\n                cvv: '',\n                cardNumber: '',\n                cpf: '',\n\n            }\n        },\n        \n        methods: {\n            checkForm() {\n                this.errors = [];\n                this.card_errors = [];\n\n                if (!this.user_name) {\n                    this.errors.push('Informe seu Nome.');\n                    this.card_errors.push('Informe o Nome impresso no cartão.');\n                }\n                if (!this.email) {\n                    this.errors.push('Informe seu melhor E-mail.');\n                } else if (!this.validEmail(this.email)) {\n                    this.errors.push('Utilize um e-mail válido.');\n                }\n\n                if (!this.password) {\n                    this.errors.push('Crie uma senha.');\n                }\n\n                if (!this.cvv) {\n                    this.card_errors.push('Informe o codigo de segurança do cartão.');\n                }\n\n                if (!this.cardNumber) {\n                    this.card_errors.push('Informe o número do cartão.');\n                }\n\n                if (!this.cpf) {\n                    this.card_errors.push('Informe o CPF.');\n                }\n\n\n            },\n\n            validEmail: function (email) {\n                var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                return re.test(email);\n            },\n\n            getBin() {\n                const cardnumber = document.getElementById(\"cardNumber\");\n                return cardnumber.value.substring(0,6);\n            },\n\n            guessingPaymentMethod(event) {\n                var bin = this.getBin();\n                if (event.type == \"keyup\") {\n                    if (bin.length >= 6) {\n                        window.Mercadopago.getPaymentMethod({\n                            \"bin\": bin\n                        }, this.setPaymentMethodInfo);\n                    }\n                } else {\n                    setTimeout(function() {\n                        if (bin.length >= 6) {\n                            window.Mercadopago.getPaymentMethod({\n                                \"bin\": bin\n                            }, this.setPaymentMethodInfo);\n                        }\n                    }, 100);\n                }\n            },\n\n\n            setPaymentMethodInfo(status, response) {\n                if (status == 200) {\n                    const paymentMethodElement = document.querySelector('input[name=paymentMethodId]');\n                    this.payment_method_id = response[0].id;\n                    console.log(this.payment_method_id);\n\n                    if (paymentMethodElement) {\n                        paymentMethodElement.value = response[0].id;\n                    } else {\n                        const input = document.createElement('input');\n                        input.setAttribute('name', 'paymentMethodId');\n                        input.setAttribute('type', 'hidden');\n                        input.setAttribute('value', response[0].id);     \n                        form.appendChild(input);\n                    }\n\n                    Mercadopago.getInstallments({\n                        \"bin\": this.getBin(),\n                        \"amount\": parseFloat(document.querySelector('#amount').value),\n                    }, this.setInstallmentInfo);\n\n                } else {\n                    alert(`payment method info error: ${response}`);  \n                }\n            },\n\n            async sdkResponseHandler(status, response) {\n                    if (status != 200 && status != 201) {\n                        /*console.log(response);\n                        alert(\"Preencha os campos\");*/\n                    }else{\n                        /*var form = document.querySelector('#pay');\n                        this.card.setAttribute('name', 'token');\n                        this.card.setAttribute('type', 'hidden');\n                        this.card.setAttribute('value', response.id);*/\n                        this.token = response.id;\n                        console.log(this.token);\n                        console.log(this.payment_method_id);\n                        console.log(this.option);\n                        //form.appendChild(this.card);\n                        \n                        \n                        //form.submit();\n\n\n                        const info = {\n                            transaction_amount: this.transaction_amount,\n                            token: this.token,\n                            description: this.description,\n                            installments: this.option,\n                            payment_method_id: this.payment_method_id,\n                            email: this.email,\n                            phone: this.phone,\n                            password: this.password,\n                            user_name: this.user_name,\n                        }\n\n                        const auth_user = {\n                            email: this.email,\n                            password: this.password\n                        }\n\n                        const data = Object.entries(info)\n                        .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                        .join(\"&\");\n\n                        const auth_data = Object.entries(auth_user)\n                        .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                        .join(\"&\");\n\n                        const options = {\n                            headers: { \"content-type\": \"application/x-www-form-urlencoded\" }\n                            };\n\n                        console.log(data);\n                        if(this.errors.length <= 0) { \n                            this.doSubmit=true;\n                            this.isLoading = true;\n                            await api.post('/processar-pagamento', data, options)\n                            .then(res =>  this.response = res.data)\n                            .catch(err => console.log(err));  \n\n                           \n                            console.log(this.response.body.status);\n                            if (this.response.body.status != 'approved') {\n                                confirm('Compra não Aprovada. Tente novamente por favor');  \n                            } else {\n                                await api.post(`/auth`, auth_data)\n                                .then(res =>  (this.auth_response = res.data))\n                                .catch(err => console.log(err));\n                                \n                                if (!this.auth_response.error) {\n                                    localStorage.setItem('user_id', this.auth_response.user._id);\n                                    localStorage.setItem('token', this.auth_response.token);\n                                    this.isLoading = false;\n                                    window.location.href = \"/aulas\";\n                                }\n\n                            }\n                            \n                            //confirm('Parabéns!!!!')\n                        \n                        }\n                        \n\n                    }\n                },\n\n                doPay(event){\n                    event.preventDefault();\n                    if(!this.doSubmit){\n                        var $form = document.querySelector('#pay');\n\n                        window.Mercadopago.createToken($form, this.sdkResponseHandler); // The function \"sdkResponseHandler\" is defined below\n\n                        return false;\n                    }\n                },\n\n                setInstallmentInfo(status, response) {\n                    var selectorInstallments = document.querySelector(\"#installments\"),\n                    fragment = document.createDocumentFragment();\n                    selectorInstallments.options.length = 0;\n\n                    if (response.length > 0) {\n                        var option = new Option(\"Escolha...\", '-1'),\n                        payerCosts = response[0].payer_costs;\n                        fragment.appendChild(option);\n\n                        for (var i = 0; i < payerCosts.length; i++) {\n                            fragment.appendChild(new Option(payerCosts[i].recommended_message, payerCosts[i].installments));\n                        }\n                        selectorInstallments.appendChild(fragment);\n                        selectorInstallments.removeAttribute('disabled');\n                    }\n                },\n\n            async pagar() {\n                     \n            },\n\n            async register() {\n                const auth_user = {\n                    email: this.email,\n                    password: this.password\n                }\n                const data = Object.entries(auth_user)\n                .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                .join(\"&\");\n                \n                if(this.email != '' && this.password != '') {          \n                    await api.post(`/auth`, data)\n                    .then(res =>  (this.response = res.data))\n                    .catch(err => console.log(err));  \n                    if (!this.response.error) {\n                        localStorage.setItem('user_id', this.response.user._id);\n                        localStorage.setItem('token', this.response.token);\n                        window.location.href = \"/aulas\";\n                    }\n                    \n                    //console.log(this.response);    \n                } else {\n                   this.error = true;\n                }              \n            },\n        },\n\n        created() {\n            //window.Mercadopago.setPublishableKey(\"TEST-faebd75e-b4ce-4884-b72d-e66e394fc207\");\n            window.Mercadopago.setPublishableKey(\"APP_USR-03e47640-4b37-4318-b43f-8133e8aae539\");\n            window.Mercadopago.getIdentificationTypes();\n        },\n}\n</script>\n<style scoped>\n    .mercadop {\n        display: flex;\n        justify-content: space-between;\n    }\n    .width50 {\n        width: 48%;\n    }\n    .margin15 {\n        margin-top: 15px;\n    }\n    select {\n        margin-right: 5px;\n    }\n\n    .flex{\n        display: flex;\n        justify-content: space-between;     \n    }\n\n    #register {\n        max-width: 600px;\n        border: 1px solid #CCCCCC;\n        background-color: #FFFFFF;\n        margin: auto;\n        margin-top: 30px;\n        padding: 20px;\n    }\n    \n    .green {\n        background-color: #38ef7d;\n        color: #ffffff;\n        font-weight: bold;\n    }\n\n    h3 {\n        margin-top: 20px;\n        color: rgb(95, 0, 172);\n        font-weight: bold;\n    }\n\n    h4 {\n        padding: 15px;\n    }\n\n    h5 {\n        color: rgb(246, 55, 226);\n        font-weight: bold;\n    }\n\n    button {\n        margin-top: 15px;\n    }\n\n    iframe {\n        width: 100%;\n        height: 80vh;\n        border: none;\n    }\n\n    img {\n        max-width: 170px;\n    }\n</style>"]}]}