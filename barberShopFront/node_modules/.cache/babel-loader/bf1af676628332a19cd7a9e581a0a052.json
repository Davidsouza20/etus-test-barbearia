{"remainingRequest":"/home/david/Documents/barberShopFront/node_modules/babel-loader/lib/index.js!/home/david/Documents/barberShopFront/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/david/Documents/barberShopFront/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/david/Documents/barberShopFront/src/views/Register.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/david/Documents/barberShopFront/src/views/Register.vue","mtime":1591997511173},{"path":"/home/david/Documents/barberShopFront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/david/Documents/barberShopFront/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _slicedToArray from \"/home/david/Documents/barberShopFront/node_modules/@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.object.entries\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/david/Documents/barberShopFront/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport api from \"../services/api\";\nimport Loading from 'vue-loading-overlay';\nimport 'vue-loading-overlay/dist/vue-loading.css';\nexport default {\n  name: 'Register',\n  components: {\n    Loading: Loading\n  },\n  data: function data() {\n    return {\n      auth_response: '',\n      isLoading: false,\n      fullPage: true,\n      errors: [],\n      card_errors: [],\n      user_name: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n      response: \"\",\n      error: false,\n      doSubmit: false,\n      card: document.createElement('input'),\n      installments: '',\n      token: '',\n      transaction_amount: '211,32',\n      description: '',\n      payment_method_id: '',\n      option: '',\n      cvv: '',\n      cardNumber: '',\n      cpf: ''\n    };\n  },\n  methods: {\n    checkForm: function checkForm() {\n      this.errors = [];\n      this.card_errors = [];\n\n      if (!this.user_name) {\n        this.errors.push('Informe seu Nome.');\n        this.card_errors.push('Informe o Nome impresso no cartão.');\n      }\n\n      if (!this.email) {\n        this.errors.push('Informe seu melhor E-mail.');\n      } else if (!this.validEmail(this.email)) {\n        this.errors.push('Utilize um e-mail válido.');\n      }\n\n      if (!this.password) {\n        this.errors.push('Crie uma senha.');\n      }\n\n      if (!this.cvv) {\n        this.card_errors.push('Informe o codigo de segurança do cartão.');\n      }\n\n      if (!this.cardNumber) {\n        this.card_errors.push('Informe o número do cartão.');\n      }\n\n      if (!this.cpf) {\n        this.card_errors.push('Informe o CPF.');\n      }\n    },\n    validEmail: function validEmail(email) {\n      var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n      return re.test(email);\n    },\n    getBin: function getBin() {\n      var cardnumber = document.getElementById(\"cardNumber\");\n      return cardnumber.value.substring(0, 6);\n    },\n    guessingPaymentMethod: function guessingPaymentMethod(event) {\n      var bin = this.getBin();\n\n      if (event.type == \"keyup\") {\n        if (bin.length >= 6) {\n          window.Mercadopago.getPaymentMethod({\n            \"bin\": bin\n          }, this.setPaymentMethodInfo);\n        }\n      } else {\n        setTimeout(function () {\n          if (bin.length >= 6) {\n            window.Mercadopago.getPaymentMethod({\n              \"bin\": bin\n            }, this.setPaymentMethodInfo);\n          }\n        }, 100);\n      }\n    },\n    setPaymentMethodInfo: function setPaymentMethodInfo(status, response) {\n      if (status == 200) {\n        var paymentMethodElement = document.querySelector('input[name=paymentMethodId]');\n        this.payment_method_id = response[0].id;\n        console.log(this.payment_method_id);\n\n        if (paymentMethodElement) {\n          paymentMethodElement.value = response[0].id;\n        } else {\n          var input = document.createElement('input');\n          input.setAttribute('name', 'paymentMethodId');\n          input.setAttribute('type', 'hidden');\n          input.setAttribute('value', response[0].id);\n          form.appendChild(input);\n        }\n\n        Mercadopago.getInstallments({\n          \"bin\": this.getBin(),\n          \"amount\": parseFloat(document.querySelector('#amount').value)\n        }, this.setInstallmentInfo);\n      } else {\n        alert(\"payment method info error: \".concat(response));\n      }\n    },\n    sdkResponseHandler: function () {\n      var _sdkResponseHandler = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(status, response) {\n        var _this = this;\n\n        var info, auth_user, data, auth_data, options;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(status != 200 && status != 201)) {\n                  _context.next = 3;\n                  break;\n                }\n\n                _context.next = 26;\n                break;\n\n              case 3:\n                /*var form = document.querySelector('#pay');\n                this.card.setAttribute('name', 'token');\n                this.card.setAttribute('type', 'hidden');\n                this.card.setAttribute('value', response.id);*/\n                this.token = response.id;\n                console.log(this.token);\n                console.log(this.payment_method_id);\n                console.log(this.option); //form.appendChild(this.card);\n                //form.submit();\n\n                info = {\n                  transaction_amount: this.transaction_amount,\n                  token: this.token,\n                  description: this.description,\n                  installments: this.option,\n                  payment_method_id: this.payment_method_id,\n                  email: this.email,\n                  phone: this.phone,\n                  password: this.password,\n                  user_name: this.user_name\n                };\n                auth_user = {\n                  email: this.email,\n                  password: this.password\n                };\n                data = Object.entries(info).map(function (_ref) {\n                  var _ref2 = _slicedToArray(_ref, 2),\n                      key = _ref2[0],\n                      val = _ref2[1];\n\n                  return \"\".concat(key, \"=\").concat(encodeURIComponent(val));\n                }).join(\"&\");\n                auth_data = Object.entries(auth_user).map(function (_ref3) {\n                  var _ref4 = _slicedToArray(_ref3, 2),\n                      key = _ref4[0],\n                      val = _ref4[1];\n\n                  return \"\".concat(key, \"=\").concat(encodeURIComponent(val));\n                }).join(\"&\");\n                options = {\n                  headers: {\n                    \"content-type\": \"application/x-www-form-urlencoded\"\n                  }\n                };\n                console.log(data);\n\n                if (!(this.errors.length <= 0)) {\n                  _context.next = 26;\n                  break;\n                }\n\n                this.doSubmit = true;\n                this.isLoading = true;\n                _context.next = 18;\n                return api.post('/processar-pagamento', data, options).then(function (res) {\n                  return _this.response = res.data;\n                }).catch(function (err) {\n                  return console.log(err);\n                });\n\n              case 18:\n                console.log(this.response.body.status);\n\n                if (!(this.response.body.status != 'approved')) {\n                  _context.next = 23;\n                  break;\n                }\n\n                confirm('Compra não Aprovada. Tente novamente por favor');\n                _context.next = 26;\n                break;\n\n              case 23:\n                _context.next = 25;\n                return api.post(\"/auth\", auth_data).then(function (res) {\n                  return _this.auth_response = res.data;\n                }).catch(function (err) {\n                  return console.log(err);\n                });\n\n              case 25:\n                if (!this.auth_response.error) {\n                  localStorage.setItem('user_id', this.auth_response.user._id);\n                  localStorage.setItem('token', this.auth_response.token);\n                  this.isLoading = false;\n                  window.location.href = \"/aulas\";\n                }\n\n              case 26:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function sdkResponseHandler(_x, _x2) {\n        return _sdkResponseHandler.apply(this, arguments);\n      }\n\n      return sdkResponseHandler;\n    }(),\n    doPay: function doPay(event) {\n      event.preventDefault();\n\n      if (!this.doSubmit) {\n        var $form = document.querySelector('#pay');\n        window.Mercadopago.createToken($form, this.sdkResponseHandler); // The function \"sdkResponseHandler\" is defined below\n\n        return false;\n      }\n    },\n    setInstallmentInfo: function setInstallmentInfo(status, response) {\n      var selectorInstallments = document.querySelector(\"#installments\"),\n          fragment = document.createDocumentFragment();\n      selectorInstallments.options.length = 0;\n\n      if (response.length > 0) {\n        var option = new Option(\"Escolha...\", '-1'),\n            payerCosts = response[0].payer_costs;\n        fragment.appendChild(option);\n\n        for (var i = 0; i < payerCosts.length; i++) {\n          fragment.appendChild(new Option(payerCosts[i].recommended_message, payerCosts[i].installments));\n        }\n\n        selectorInstallments.appendChild(fragment);\n        selectorInstallments.removeAttribute('disabled');\n      }\n    },\n    pagar: function () {\n      var _pagar = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      function pagar() {\n        return _pagar.apply(this, arguments);\n      }\n\n      return pagar;\n    }(),\n    register: function () {\n      var _register = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee3() {\n        var _this2 = this;\n\n        var auth_user, data;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                auth_user = {\n                  email: this.email,\n                  password: this.password\n                };\n                data = Object.entries(auth_user).map(function (_ref5) {\n                  var _ref6 = _slicedToArray(_ref5, 2),\n                      key = _ref6[0],\n                      val = _ref6[1];\n\n                  return \"\".concat(key, \"=\").concat(encodeURIComponent(val));\n                }).join(\"&\");\n\n                if (!(this.email != '' && this.password != '')) {\n                  _context3.next = 8;\n                  break;\n                }\n\n                _context3.next = 5;\n                return api.post(\"/auth\", data).then(function (res) {\n                  return _this2.response = res.data;\n                }).catch(function (err) {\n                  return console.log(err);\n                });\n\n              case 5:\n                if (!this.response.error) {\n                  localStorage.setItem('user_id', this.response.user._id);\n                  localStorage.setItem('token', this.response.token);\n                  window.location.href = \"/aulas\";\n                } //console.log(this.response);    \n\n\n                _context3.next = 9;\n                break;\n\n              case 8:\n                this.error = true;\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function register() {\n        return _register.apply(this, arguments);\n      }\n\n      return register;\n    }()\n  },\n  created: function created() {\n    //window.Mercadopago.setPublishableKey(\"TEST-faebd75e-b4ce-4884-b72d-e66e394fc207\");\n    window.Mercadopago.setPublishableKey(\"APP_USR-03e47640-4b37-4318-b43f-8133e8aae539\");\n    window.Mercadopago.getIdentificationTypes();\n  }\n};",{"version":3,"sources":["Register.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA,OAAA,GAAA;AACA,OAAA,OAAA,MAAA,qBAAA;AACA,OAAA,0CAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,UADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,OAAA,EAAA;AADA,GAFA;AAMA,EAAA,IANA,kBAMA;AACA,WAAA;AACA,MAAA,aAAA,EAAA,EADA;AAEA,MAAA,SAAA,EAAA,KAFA;AAGA,MAAA,QAAA,EAAA,IAHA;AAIA,MAAA,MAAA,EAAA,EAJA;AAKA,MAAA,WAAA,EAAA,EALA;AAMA,MAAA,SAAA,EAAA,EANA;AAOA,MAAA,KAAA,EAAA,EAPA;AAQA,MAAA,KAAA,EAAA,EARA;AASA,MAAA,QAAA,EAAA,EATA;AAUA,MAAA,QAAA,EAAA,EAVA;AAWA,MAAA,KAAA,EAAA,KAXA;AAYA,MAAA,QAAA,EAAA,KAZA;AAaA,MAAA,IAAA,EAAA,QAAA,CAAA,aAAA,CAAA,OAAA,CAbA;AAcA,MAAA,YAAA,EAAA,EAdA;AAeA,MAAA,KAAA,EAAA,EAfA;AAgBA,MAAA,kBAAA,EAAA,QAhBA;AAiBA,MAAA,WAAA,EAAA,EAjBA;AAkBA,MAAA,iBAAA,EAAA,EAlBA;AAmBA,MAAA,MAAA,EAAA,EAnBA;AAoBA,MAAA,GAAA,EAAA,EApBA;AAqBA,MAAA,UAAA,EAAA,EArBA;AAsBA,MAAA,GAAA,EAAA;AAtBA,KAAA;AAyBA,GAhCA;AAkCA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,uBACA;AACA,WAAA,MAAA,GAAA,EAAA;AACA,WAAA,WAAA,GAAA,EAAA;;AAEA,UAAA,CAAA,KAAA,SAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,mBAAA;AACA,aAAA,WAAA,CAAA,IAAA,CAAA,oCAAA;AACA;;AACA,UAAA,CAAA,KAAA,KAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,4BAAA;AACA,OAFA,MAEA,IAAA,CAAA,KAAA,UAAA,CAAA,KAAA,KAAA,CAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,2BAAA;AACA;;AAEA,UAAA,CAAA,KAAA,QAAA,EAAA;AACA,aAAA,MAAA,CAAA,IAAA,CAAA,iBAAA;AACA;;AAEA,UAAA,CAAA,KAAA,GAAA,EAAA;AACA,aAAA,WAAA,CAAA,IAAA,CAAA,0CAAA;AACA;;AAEA,UAAA,CAAA,KAAA,UAAA,EAAA;AACA,aAAA,WAAA,CAAA,IAAA,CAAA,6BAAA;AACA;;AAEA,UAAA,CAAA,KAAA,GAAA,EAAA;AACA,aAAA,WAAA,CAAA,IAAA,CAAA,gBAAA;AACA;AAGA,KAhCA;AAkCA,IAAA,UAAA,EAAA,oBAAA,KAAA,EAAA;AACA,UAAA,EAAA,GAAA,yJAAA;AACA,aAAA,EAAA,CAAA,IAAA,CAAA,KAAA,CAAA;AACA,KArCA;AAuCA,IAAA,MAvCA,oBAuCA;AACA,UAAA,UAAA,GAAA,QAAA,CAAA,cAAA,CAAA,YAAA,CAAA;AACA,aAAA,UAAA,CAAA,KAAA,CAAA,SAAA,CAAA,CAAA,EAAA,CAAA,CAAA;AACA,KA1CA;AA4CA,IAAA,qBA5CA,iCA4CA,KA5CA,EA4CA;AACA,UAAA,GAAA,GAAA,KAAA,MAAA,EAAA;;AACA,UAAA,KAAA,CAAA,IAAA,IAAA,OAAA,EAAA;AACA,YAAA,GAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,UAAA,MAAA,CAAA,WAAA,CAAA,gBAAA,CAAA;AACA,mBAAA;AADA,WAAA,EAEA,KAAA,oBAFA;AAGA;AACA,OANA,MAMA;AACA,QAAA,UAAA,CAAA,YAAA;AACA,cAAA,GAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,WAAA,CAAA,gBAAA,CAAA;AACA,qBAAA;AADA,aAAA,EAEA,KAAA,oBAFA;AAGA;AACA,SANA,EAMA,GANA,CAAA;AAOA;AACA,KA7DA;AAgEA,IAAA,oBAhEA,gCAgEA,MAhEA,EAgEA,QAhEA,EAgEA;AACA,UAAA,MAAA,IAAA,GAAA,EAAA;AACA,YAAA,oBAAA,GAAA,QAAA,CAAA,aAAA,CAAA,6BAAA,CAAA;AACA,aAAA,iBAAA,GAAA,QAAA,CAAA,CAAA,CAAA,CAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,KAAA,iBAAA;;AAEA,YAAA,oBAAA,EAAA;AACA,UAAA,oBAAA,CAAA,KAAA,GAAA,QAAA,CAAA,CAAA,CAAA,CAAA,EAAA;AACA,SAFA,MAEA;AACA,cAAA,KAAA,GAAA,QAAA,CAAA,aAAA,CAAA,OAAA,CAAA;AACA,UAAA,KAAA,CAAA,YAAA,CAAA,MAAA,EAAA,iBAAA;AACA,UAAA,KAAA,CAAA,YAAA,CAAA,MAAA,EAAA,QAAA;AACA,UAAA,KAAA,CAAA,YAAA,CAAA,OAAA,EAAA,QAAA,CAAA,CAAA,CAAA,CAAA,EAAA;AACA,UAAA,IAAA,CAAA,WAAA,CAAA,KAAA;AACA;;AAEA,QAAA,WAAA,CAAA,eAAA,CAAA;AACA,iBAAA,KAAA,MAAA,EADA;AAEA,oBAAA,UAAA,CAAA,QAAA,CAAA,aAAA,CAAA,SAAA,EAAA,KAAA;AAFA,SAAA,EAGA,KAAA,kBAHA;AAKA,OApBA,MAoBA;AACA,QAAA,KAAA,sCAAA,QAAA,EAAA;AACA;AACA,KAxFA;AA0FA,IAAA,kBA1FA;AAAA;AAAA;AAAA,+CA0FA,MA1FA,EA0FA,QA1FA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBA2FA,MAAA,IAAA,GAAA,IAAA,MAAA,IAAA,GA3FA;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AA+FA;;;;AAIA,qBAAA,KAAA,GAAA,QAAA,CAAA,EAAA;AACA,gBAAA,OAAA,CAAA,GAAA,CAAA,KAAA,KAAA;AACA,gBAAA,OAAA,CAAA,GAAA,CAAA,KAAA,iBAAA;AACA,gBAAA,OAAA,CAAA,GAAA,CAAA,KAAA,MAAA,EAtGA,CAuGA;AAGA;;AAGA,gBAAA,IA7GA,GA6GA;AACA,kBAAA,kBAAA,EAAA,KAAA,kBADA;AAEA,kBAAA,KAAA,EAAA,KAAA,KAFA;AAGA,kBAAA,WAAA,EAAA,KAAA,WAHA;AAIA,kBAAA,YAAA,EAAA,KAAA,MAJA;AAKA,kBAAA,iBAAA,EAAA,KAAA,iBALA;AAMA,kBAAA,KAAA,EAAA,KAAA,KANA;AAOA,kBAAA,KAAA,EAAA,KAAA,KAPA;AAQA,kBAAA,QAAA,EAAA,KAAA,QARA;AASA,kBAAA,SAAA,EAAA,KAAA;AATA,iBA7GA;AAyHA,gBAAA,SAzHA,GAyHA;AACA,kBAAA,KAAA,EAAA,KAAA,KADA;AAEA,kBAAA,QAAA,EAAA,KAAA;AAFA,iBAzHA;AA8HA,gBAAA,IA9HA,GA8HA,MAAA,CAAA,OAAA,CAAA,IAAA,EACA,GADA,CACA;AAAA;AAAA,sBAAA,GAAA;AAAA,sBAAA,GAAA;;AAAA,mCAAA,GAAA,cAAA,kBAAA,CAAA,GAAA,CAAA;AAAA,iBADA,EAEA,IAFA,CAEA,GAFA,CA9HA;AAkIA,gBAAA,SAlIA,GAkIA,MAAA,CAAA,OAAA,CAAA,SAAA,EACA,GADA,CACA;AAAA;AAAA,sBAAA,GAAA;AAAA,sBAAA,GAAA;;AAAA,mCAAA,GAAA,cAAA,kBAAA,CAAA,GAAA,CAAA;AAAA,iBADA,EAEA,IAFA,CAEA,GAFA,CAlIA;AAsIA,gBAAA,OAtIA,GAsIA;AACA,kBAAA,OAAA,EAAA;AAAA,oCAAA;AAAA;AADA,iBAtIA;AA0IA,gBAAA,OAAA,CAAA,GAAA,CAAA,IAAA;;AA1IA,sBA2IA,KAAA,MAAA,CAAA,MAAA,IAAA,CA3IA;AAAA;AAAA;AAAA;;AA4IA,qBAAA,QAAA,GAAA,IAAA;AACA,qBAAA,SAAA,GAAA,IAAA;AA7IA;AAAA,uBA8IA,GAAA,CAAA,IAAA,CAAA,sBAAA,EAAA,IAAA,EAAA,OAAA,EACA,IADA,CACA,UAAA,GAAA;AAAA,yBAAA,KAAA,CAAA,QAAA,GAAA,GAAA,CAAA,IAAA;AAAA,iBADA,EAEA,KAFA,CAEA,UAAA,GAAA;AAAA,yBAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AAAA,iBAFA,CA9IA;;AAAA;AAmJA,gBAAA,OAAA,CAAA,GAAA,CAAA,KAAA,QAAA,CAAA,IAAA,CAAA,MAAA;;AAnJA,sBAoJA,KAAA,QAAA,CAAA,IAAA,CAAA,MAAA,IAAA,UApJA;AAAA;AAAA;AAAA;;AAqJA,gBAAA,OAAA,CAAA,gDAAA,CAAA;AArJA;AAAA;;AAAA;AAAA;AAAA,uBAuJA,GAAA,CAAA,IAAA,UAAA,SAAA,EACA,IADA,CACA,UAAA,GAAA;AAAA,yBAAA,KAAA,CAAA,aAAA,GAAA,GAAA,CAAA,IAAA;AAAA,iBADA,EAEA,KAFA,CAEA,UAAA,GAAA;AAAA,yBAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AAAA,iBAFA,CAvJA;;AAAA;AA2JA,oBAAA,CAAA,KAAA,aAAA,CAAA,KAAA,EAAA;AACA,kBAAA,YAAA,CAAA,OAAA,CAAA,SAAA,EAAA,KAAA,aAAA,CAAA,IAAA,CAAA,GAAA;AACA,kBAAA,YAAA,CAAA,OAAA,CAAA,OAAA,EAAA,KAAA,aAAA,CAAA,KAAA;AACA,uBAAA,SAAA,GAAA,KAAA;AACA,kBAAA,MAAA,CAAA,QAAA,CAAA,IAAA,GAAA,QAAA;AACA;;AAhKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA4KA,IAAA,KA5KA,iBA4KA,KA5KA,EA4KA;AACA,MAAA,KAAA,CAAA,cAAA;;AACA,UAAA,CAAA,KAAA,QAAA,EAAA;AACA,YAAA,KAAA,GAAA,QAAA,CAAA,aAAA,CAAA,MAAA,CAAA;AAEA,QAAA,MAAA,CAAA,WAAA,CAAA,WAAA,CAAA,KAAA,EAAA,KAAA,kBAAA,EAHA,CAGA;;AAEA,eAAA,KAAA;AACA;AACA,KArLA;AAuLA,IAAA,kBAvLA,8BAuLA,MAvLA,EAuLA,QAvLA,EAuLA;AACA,UAAA,oBAAA,GAAA,QAAA,CAAA,aAAA,CAAA,eAAA,CAAA;AAAA,UACA,QAAA,GAAA,QAAA,CAAA,sBAAA,EADA;AAEA,MAAA,oBAAA,CAAA,OAAA,CAAA,MAAA,GAAA,CAAA;;AAEA,UAAA,QAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,YAAA,MAAA,GAAA,IAAA,MAAA,CAAA,YAAA,EAAA,IAAA,CAAA;AAAA,YACA,UAAA,GAAA,QAAA,CAAA,CAAA,CAAA,CAAA,WADA;AAEA,QAAA,QAAA,CAAA,WAAA,CAAA,MAAA;;AAEA,aAAA,IAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,UAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,UAAA,QAAA,CAAA,WAAA,CAAA,IAAA,MAAA,CAAA,UAAA,CAAA,CAAA,CAAA,CAAA,mBAAA,EAAA,UAAA,CAAA,CAAA,CAAA,CAAA,YAAA,CAAA;AACA;;AACA,QAAA,oBAAA,CAAA,WAAA,CAAA,QAAA;AACA,QAAA,oBAAA,CAAA,eAAA,CAAA,UAAA;AACA;AACA,KAvMA;AAyMA,IAAA,KAzMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA6MA,IAAA,QA7MA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AA8MA,gBAAA,SA9MA,GA8MA;AACA,kBAAA,KAAA,EAAA,KAAA,KADA;AAEA,kBAAA,QAAA,EAAA,KAAA;AAFA,iBA9MA;AAkNA,gBAAA,IAlNA,GAkNA,MAAA,CAAA,OAAA,CAAA,SAAA,EACA,GADA,CACA;AAAA;AAAA,sBAAA,GAAA;AAAA,sBAAA,GAAA;;AAAA,mCAAA,GAAA,cAAA,kBAAA,CAAA,GAAA,CAAA;AAAA,iBADA,EAEA,IAFA,CAEA,GAFA,CAlNA;;AAAA,sBAsNA,KAAA,KAAA,IAAA,EAAA,IAAA,KAAA,QAAA,IAAA,EAtNA;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAuNA,GAAA,CAAA,IAAA,UAAA,IAAA,EACA,IADA,CACA,UAAA,GAAA;AAAA,yBAAA,MAAA,CAAA,QAAA,GAAA,GAAA,CAAA,IAAA;AAAA,iBADA,EAEA,KAFA,CAEA,UAAA,GAAA;AAAA,yBAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AAAA,iBAFA,CAvNA;;AAAA;AA0NA,oBAAA,CAAA,KAAA,QAAA,CAAA,KAAA,EAAA;AACA,kBAAA,YAAA,CAAA,OAAA,CAAA,SAAA,EAAA,KAAA,QAAA,CAAA,IAAA,CAAA,GAAA;AACA,kBAAA,YAAA,CAAA,OAAA,CAAA,OAAA,EAAA,KAAA,QAAA,CAAA,KAAA;AACA,kBAAA,MAAA,CAAA,QAAA,CAAA,IAAA,GAAA,QAAA;AACA,iBA9NA,CAgOA;;;AAhOA;AAAA;;AAAA;AAkOA,qBAAA,KAAA,GAAA,IAAA;;AAlOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAlCA;AAyQA,EAAA,OAzQA,qBAyQA;AACA;AACA,IAAA,MAAA,CAAA,WAAA,CAAA,iBAAA,CAAA,8CAAA;AACA,IAAA,MAAA,CAAA,WAAA,CAAA,sBAAA;AACA;AA7QA,CAAA","sourcesContent":["<template>\n    <div>\n        <!--<div>\n            <h3> 12 meses de acesso ilimitado</h3>\n            <h4>Aulas novas toda semana e uma rotina de treinos personalizada para você.  <br><br> Elimine a gordura indesejada se divertindo.</h4>\n        </div> -->\n        <br>\n        <img src=\"img/garantee.png\" alt=\"Garantia\">\n\n        <form action=\"\" method=\"POST\"  id=\"pay\" name=\"pay\" v-on:change=\"checkForm\">\n         <div id=\"register\">\n            <h4 class=\"modal-title w-100 font-weight-bold\">Dados Pessoais</h4>\n            <div class=\"form-group\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n                <input type=\"text\" required class=\"form-control\"  placeholder=\"Nome\" v-model=\"user_name\">\n\n                <i class=\"fa fa-phone\"></i>\n                <input type=\"text\" class=\"form-control\" aria-describedby=\"emailHelp\" placeholder=\"Telefone\" v-model=\"phone\">\n\n                <i class=\"fa fa-envelope-o\" aria-hidden=\"true\"></i>\n                <input type=\"email\" class=\"form-control\" id=\"exampleInputEmail1\" aria-describedby=\"emailHelp\" placeholder=\"E-mail\" v-model=\"email\">\n            </div>\n            <div class=\"form-group\">\n                <i class=\"fa fa-lock\" aria-hidden=\"true\"></i>\n                <input type=\"password\" class=\"form-control\" id=\"exampleInputPassword1\" placeholder=\"Senha\" v-model=\"password\">\n            </div>  \n            <div v-if=\"errors.length\" class=\"alert alert-danger\" role=\"alert\">\n            <span v-for =\"error in errors\" :key=\"error.id\">{{ error }}<br></span>\n        </div>     \n        </div>\n\n        <div id=\"register\">\n            <div class=\"mercadop\">\n                <h4 class=\"modal-title font-weight-bold\">Cartão de Crédito</h4>\n                <img src=\"/img/mercadopago.png\" alt=\"\">\n            </div>\n            \n            \n            <div class=\"form-group\">\n                <i class=\"fa fa-user\" aria-hidden=\"true\"></i>\n                <input type=\"text\" class=\"form-control\"  placeholder=\"Nome impresso no cartão\" v-model=\"user_name\" id=\"cardholderName\" data-checkout=\"cardholderName\">\n\n                <i class=\"fa fa-credit-card\"></i>\n                <input type=\"text\" class=\"form-control\" id=\"cardNumber\" data-checkout=\"cardNumber\" placeholder=\"Número do Cartão de Crédito\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off  v-on:keyup=\"guessingPaymentMethod\" v-on:change=\"guessingPaymentMethod\" v-model=\"cardNumber\"/>\n\n                <div class=\"flex margin15\">\n                    <div class=\"width50\">\n                        <label>Validade do Cartão</label>\n                        <div class=\"flex\">\n                            <select class=\"form-control\" id=\"cardExpirationMonth\" data-checkout=\"cardExpirationMonth\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off>\n                                <option value=\"01\">01 - janeiro</option>\n                                <option value=\"02\">02 - fevereiro</option>\n                                <option value=\"03\">03 - março</option>\n                                <option value=\"04\">04 - abril</option>\n                                <option value=\"05\">05 - maio</option>\n                                <option value=\"06\">06 - junho</option>\n                                <option value=\"07\">07 - julho</option>\n                                <option value=\"08\">08 - agosto</option>\n                                <option value=\"09\">09 - setembro</option>\n                                <option value=\"10\">10 - outubro</option>\n                                <option value=\"11\">11 - novembro</option>\n                                <option value=\"12\">12 - dezembro</option>\n                            </select>\n\n                            <select class=\"form-control\" id=\"cardExpirationYear\" data-checkout=\"cardExpirationYear\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off>\n                                <option value=\"2020\">2020</option>\n                                <option value=\"2021\">2021</option>\n                                <option value=\"2022\">2022</option>\n                                <option value=\"2023\">2023</option>\n                                <option value=\"2024\">2024</option>\n                                <option value=\"2025\">2025</option>\n                                <option value=\"2026\">2026</option>\n                                <option value=\"2027\">2027</option>\n                                <option value=\"2028\">2028</option>\n                                <option value=\"2029\">2029</option>\n                                <option value=\"2030\">2030</option>\n                                <option value=\"2031\">2031</option>\n                                <option value=\"2032\">2032</option>\n                                <option value=\"2033\">2033</option>\n                                <option value=\"2034\">2034</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div class=\"width50\">\n                        <label for=\"cardNumber\">Código de Segurança</label>\n                        <input type=\"text\" class=\"form-control\" id=\"securityCode\" data-checkout=\"securityCode\" placeholder=\"CVV\" onselectstart=\"return false\" onpaste=\"return false\" onCopy=\"return false\" onCut=\"return false\" onDrag=\"return false\" onDrop=\"return false\" autocomplete=off v-model=\"cvv\">  \n                    </div>\n                </div>  \n\n                <div class=\"flex margin15\">\n                    <div class=\"width50\">\n                        <label for=\"docType\">Tipo do Documento</label><br>\n                        <select id=\"docType\" class=\"form-control\" data-checkout=\"docType\"></select>\n                    </div>\n                    \n                    <div class=\"width50\">\n                        <label for=\"docNumber\">Número do Documento</label><br>\n                        <input type=\"text\" id=\"docNumber\" class=\"form-control\" data-checkout=\"docNumber\" placeholder=\"***.***.***-**\" v-model=\"cpf\"/>\n                    </div>\n                </div>\n                 \n                 <div class=\"margin15\">\n                     <i class=\"fa fa-money\" aria-hidden=\"true\"></i>&nbsp;&nbsp;\n                     <label for=\"installments\">Parcelamento</label>\n                    <select id=\"installments\" class=\"form-control\" name=\"installments\" v-model=\"option\"></select>\n                 </div>\n            </div>\n            <div v-if=\"card_errors.length\" class=\"alert alert-danger\" role=\"alert\">\n                <span v-for =\"error in card_errors\" :key=\"error.id\">{{ error }}<br></span>\n            </div>    \n        </div>\n        \n        <input type=\"hidden\" name=\"amount\" id=\"amount\" v-model=\"transaction_amount\"/>\n        <input type=\"hidden\" name=\"description\"/>\n        <input type=\"hidden\" name=\"paymentMethodId\" v-model=\"payment_method_id\"/>\n\n         \n        <br>\n        <input type=\"submit\" class=\"btn green\" @click=\"doPay\" value=\"Eu quero emagrecer\">\n        </form>\n        <br>\n\n        <loading :active.sync=\"isLoading\" \n        :can-cancel=\"false\" \n        :on-cancel=\"() => {}\"\n        :is-full-page=\"fullPage\"\n        :loader=\"'dots'\"\n        :color=\"'#38ef7d'\"></loading>\n    </div>\n    \n\n</template>\n<script>\nimport api from '../services/api'\nimport Loading from 'vue-loading-overlay'\nimport 'vue-loading-overlay/dist/vue-loading.css'\n\nexport default {\n    name: 'Register',\n        components: {\n                Loading\n        },\n        \n        data() {\n            return {\n                auth_response: '',\n                isLoading: false,\n                fullPage: true,\n                errors: [],\n                card_errors: [],\n                user_name: \"\",\n                email: \"\",\n                phone: \"\",\n                password: \"\",\n                response: \"\",\n                error: false,\n                doSubmit: false,\n                card: document.createElement('input'),\n                installments: '',\n                token: '',\n                transaction_amount: '211,32',\n                description: '', \n                payment_method_id: '',\n                option: '',\n                cvv: '',\n                cardNumber: '',\n                cpf: '',\n\n            }\n        },\n        \n        methods: {\n            checkForm() {\n                this.errors = [];\n                this.card_errors = [];\n\n                if (!this.user_name) {\n                    this.errors.push('Informe seu Nome.');\n                    this.card_errors.push('Informe o Nome impresso no cartão.');\n                }\n                if (!this.email) {\n                    this.errors.push('Informe seu melhor E-mail.');\n                } else if (!this.validEmail(this.email)) {\n                    this.errors.push('Utilize um e-mail válido.');\n                }\n\n                if (!this.password) {\n                    this.errors.push('Crie uma senha.');\n                }\n\n                if (!this.cvv) {\n                    this.card_errors.push('Informe o codigo de segurança do cartão.');\n                }\n\n                if (!this.cardNumber) {\n                    this.card_errors.push('Informe o número do cartão.');\n                }\n\n                if (!this.cpf) {\n                    this.card_errors.push('Informe o CPF.');\n                }\n\n\n            },\n\n            validEmail: function (email) {\n                var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                return re.test(email);\n            },\n\n            getBin() {\n                const cardnumber = document.getElementById(\"cardNumber\");\n                return cardnumber.value.substring(0,6);\n            },\n\n            guessingPaymentMethod(event) {\n                var bin = this.getBin();\n                if (event.type == \"keyup\") {\n                    if (bin.length >= 6) {\n                        window.Mercadopago.getPaymentMethod({\n                            \"bin\": bin\n                        }, this.setPaymentMethodInfo);\n                    }\n                } else {\n                    setTimeout(function() {\n                        if (bin.length >= 6) {\n                            window.Mercadopago.getPaymentMethod({\n                                \"bin\": bin\n                            }, this.setPaymentMethodInfo);\n                        }\n                    }, 100);\n                }\n            },\n\n\n            setPaymentMethodInfo(status, response) {\n                if (status == 200) {\n                    const paymentMethodElement = document.querySelector('input[name=paymentMethodId]');\n                    this.payment_method_id = response[0].id;\n                    console.log(this.payment_method_id);\n\n                    if (paymentMethodElement) {\n                        paymentMethodElement.value = response[0].id;\n                    } else {\n                        const input = document.createElement('input');\n                        input.setAttribute('name', 'paymentMethodId');\n                        input.setAttribute('type', 'hidden');\n                        input.setAttribute('value', response[0].id);     \n                        form.appendChild(input);\n                    }\n\n                    Mercadopago.getInstallments({\n                        \"bin\": this.getBin(),\n                        \"amount\": parseFloat(document.querySelector('#amount').value),\n                    }, this.setInstallmentInfo);\n\n                } else {\n                    alert(`payment method info error: ${response}`);  \n                }\n            },\n\n            async sdkResponseHandler(status, response) {\n                    if (status != 200 && status != 201) {\n                        /*console.log(response);\n                        alert(\"Preencha os campos\");*/\n                    }else{\n                        /*var form = document.querySelector('#pay');\n                        this.card.setAttribute('name', 'token');\n                        this.card.setAttribute('type', 'hidden');\n                        this.card.setAttribute('value', response.id);*/\n                        this.token = response.id;\n                        console.log(this.token);\n                        console.log(this.payment_method_id);\n                        console.log(this.option);\n                        //form.appendChild(this.card);\n                        \n                        \n                        //form.submit();\n\n\n                        const info = {\n                            transaction_amount: this.transaction_amount,\n                            token: this.token,\n                            description: this.description,\n                            installments: this.option,\n                            payment_method_id: this.payment_method_id,\n                            email: this.email,\n                            phone: this.phone,\n                            password: this.password,\n                            user_name: this.user_name,\n                        }\n\n                        const auth_user = {\n                            email: this.email,\n                            password: this.password\n                        }\n\n                        const data = Object.entries(info)\n                        .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                        .join(\"&\");\n\n                        const auth_data = Object.entries(auth_user)\n                        .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                        .join(\"&\");\n\n                        const options = {\n                            headers: { \"content-type\": \"application/x-www-form-urlencoded\" }\n                            };\n\n                        console.log(data);\n                        if(this.errors.length <= 0) { \n                            this.doSubmit=true;\n                            this.isLoading = true;\n                            await api.post('/processar-pagamento', data, options)\n                            .then(res =>  this.response = res.data)\n                            .catch(err => console.log(err));  \n\n                           \n                            console.log(this.response.body.status);\n                            if (this.response.body.status != 'approved') {\n                                confirm('Compra não Aprovada. Tente novamente por favor');  \n                            } else {\n                                await api.post(`/auth`, auth_data)\n                                .then(res =>  (this.auth_response = res.data))\n                                .catch(err => console.log(err));\n                                \n                                if (!this.auth_response.error) {\n                                    localStorage.setItem('user_id', this.auth_response.user._id);\n                                    localStorage.setItem('token', this.auth_response.token);\n                                    this.isLoading = false;\n                                    window.location.href = \"/aulas\";\n                                }\n\n                            }\n                            \n                            //confirm('Parabéns!!!!')\n                        \n                        }\n                        \n\n                    }\n                },\n\n                doPay(event){\n                    event.preventDefault();\n                    if(!this.doSubmit){\n                        var $form = document.querySelector('#pay');\n\n                        window.Mercadopago.createToken($form, this.sdkResponseHandler); // The function \"sdkResponseHandler\" is defined below\n\n                        return false;\n                    }\n                },\n\n                setInstallmentInfo(status, response) {\n                    var selectorInstallments = document.querySelector(\"#installments\"),\n                    fragment = document.createDocumentFragment();\n                    selectorInstallments.options.length = 0;\n\n                    if (response.length > 0) {\n                        var option = new Option(\"Escolha...\", '-1'),\n                        payerCosts = response[0].payer_costs;\n                        fragment.appendChild(option);\n\n                        for (var i = 0; i < payerCosts.length; i++) {\n                            fragment.appendChild(new Option(payerCosts[i].recommended_message, payerCosts[i].installments));\n                        }\n                        selectorInstallments.appendChild(fragment);\n                        selectorInstallments.removeAttribute('disabled');\n                    }\n                },\n\n            async pagar() {\n                     \n            },\n\n            async register() {\n                const auth_user = {\n                    email: this.email,\n                    password: this.password\n                }\n                const data = Object.entries(auth_user)\n                .map(([key, val]) => `${key}=${encodeURIComponent(val)}`)\n                .join(\"&\");\n                \n                if(this.email != '' && this.password != '') {          \n                    await api.post(`/auth`, data)\n                    .then(res =>  (this.response = res.data))\n                    .catch(err => console.log(err));  \n                    if (!this.response.error) {\n                        localStorage.setItem('user_id', this.response.user._id);\n                        localStorage.setItem('token', this.response.token);\n                        window.location.href = \"/aulas\";\n                    }\n                    \n                    //console.log(this.response);    \n                } else {\n                   this.error = true;\n                }              \n            },\n        },\n\n        created() {\n            //window.Mercadopago.setPublishableKey(\"TEST-faebd75e-b4ce-4884-b72d-e66e394fc207\");\n            window.Mercadopago.setPublishableKey(\"APP_USR-03e47640-4b37-4318-b43f-8133e8aae539\");\n            window.Mercadopago.getIdentificationTypes();\n        },\n}\n</script>\n<style scoped>\n    .mercadop {\n        display: flex;\n        justify-content: space-between;\n    }\n    .width50 {\n        width: 48%;\n    }\n    .margin15 {\n        margin-top: 15px;\n    }\n    select {\n        margin-right: 5px;\n    }\n\n    .flex{\n        display: flex;\n        justify-content: space-between;     \n    }\n\n    #register {\n        max-width: 600px;\n        border: 1px solid #CCCCCC;\n        background-color: #FFFFFF;\n        margin: auto;\n        margin-top: 30px;\n        padding: 20px;\n    }\n    \n    .green {\n        background-color: #38ef7d;\n        color: #ffffff;\n        font-weight: bold;\n    }\n\n    h3 {\n        margin-top: 20px;\n        color: rgb(95, 0, 172);\n        font-weight: bold;\n    }\n\n    h4 {\n        padding: 15px;\n    }\n\n    h5 {\n        color: rgb(246, 55, 226);\n        font-weight: bold;\n    }\n\n    button {\n        margin-top: 15px;\n    }\n\n    iframe {\n        width: 100%;\n        height: 80vh;\n        border: none;\n    }\n\n    img {\n        max-width: 170px;\n    }\n</style>"],"sourceRoot":"src/views"}]}